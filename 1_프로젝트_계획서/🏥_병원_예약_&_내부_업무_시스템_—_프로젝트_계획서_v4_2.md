# 🏥 병원 예약 & 내부 업무 시스템 — 프로젝트 계획서 v4.2

> **문서 버전:** v4.2
**작성일:** 2026년
**개발 기간:** 4주 (고정)
**팀 구성:** 책임개발자 1명 + 개발자 3명 + AI 보조
**목표 성공 확률:** 80~88%
**연관 문서:** ERD v2.0 / API 명세서 v2.1 / 화면 정의서 v1.2
> 

---

## 📌 v4.1 → v4.2 변경 사항

| 항목 | v4.1 | v4.2 |
| --- | --- | --- |
| 전체 화면 수 | 22개 | **33개** (+11개) |
| API 엔드포인트 수 | 48개 | **61개** (+13개) |
| 신규 화면 | — | 비회원 메인·각 ROLE 대시보드(3종)·방문 접수·전체 접수 목록·진료과 상세·물품 등록·물품 상세수정·규칙 등록·규칙 상세수정 |
| 물품 API | `updateQuantity` (수량만 수정) | **`update` (전체 필드 수정)** — 별도 상세화면 도입으로 통합 |
| 목록 화면 | 페이징·검색 미정의 | **모든 목록 화면 페이징 20건·검색·필터 정의 완료** |
| 연관 문서 | 프로젝트 계획서 v4.0 / ERD v1.0 | ERD v2.0 / API 명세서 v2.1 / 화면 정의서 v1.2 |

---

## 📌 v4.0 → v4.1 변경 사항

| 항목 | v4.0 | v4.1 |
| --- | --- | --- |
| 개발 기간 | 5주 | **4주 (고정, 압축)** |
| 증상 입력 방식 | 텍스트 + 이미지 | **텍스트 전용** |
| 이미지 업로드 기능 | 있음 | **제거** |
| LLM_RECOMMENDATION 테이블 | `has_image` 컬럼 포함 | **`has_image` 컬럼 제거** |
| 전체 기능 범위 | v4.0 동일 | **v4.0 동일 (유지)** |
| 주차 구성 | W1~W4 기본 + W5 마무리 | **W1~W4 전체 압축 재편성** |

> ⚠️ **4주 압축 전략 핵심:** LLM 기능을 W3 후반부터 선행 착수하고, W4 전체를 LLM 통합 + 마무리 병행으로 구성한다. 기능 축소 없이 일정만 당긴다.
> 

---

## 1. 프로젝트 개요

### 1.1 목표 정의 (SMART 기준)

| 구분 | 목표 |
| --- | --- |
| **S**pecific | 비회원 증상 기반 예약 추천(텍스트) + 규칙 Q&A 챗봇 + 접수·진료·관리 전체 기능 |
| **M**easurable | **4주** 내 MVP 100% 완료 / LLM 추천 응답 5초 이내 / E2E 시나리오 테스트 통과 |
| **A**chievable | LLM은 책임개발자가 W3 말부터 선행 착수, 개발자는 화면 단위 병렬 진행 |
| **R**elevant | 환자 예약 진입 장벽 완화 + 직원 반복 질의 응대 업무 경감 |
| **T**ime-bound | **4주차 말 전체 MVP 배포 완료**, 추가 기능은 v1.1로 Scope Lock |

### 1.2 전체 시스템 구조

```
[외부 — 비회원 환자]
  └─ 증상 텍스트 입력
       ↓ Claude API 분석
  └─ 진료과·의사·시간 추천
       ↓ 환자 확인 후
  └─ 예약 확정  ←→  직접 선택 예약 (폴백)

[내부 — 직원 로그인]
  ├─ ROLE_STAFF   → 접수 처리
  ├─ ROLE_DOCTOR  → 진료 기록 + 병원 규칙 Q&A 챗봇
  ├─ ROLE_NURSE   → 예약 목록 조회 + 병원 규칙 Q&A 챗봇
  └─ ROLE_ADMIN   → 전체 관리 + 병원 규칙 CRUD
```

---

## 2. LLM 기능 상세 정의

### 2.1 기능 1 — 증상 기반 예약 추천 (외부 환자용, 텍스트 전용)

### 화면 흐름

```
[증상 입력 화면]  /reservation/symptom
┌──────────────────────────────────────────┐
│  증상을 입력하면 AI가 진료과와 의사를    │
│  추천해 드립니다.                        │
│                                          │
│  ┌────────────────────────────────────┐  │
│  │ 3일 전부터 오른쪽 아랫배가 아프고  │  │
│  │ 미열이 지속됩니다.                 │  │
│  └────────────────────────────────────┘  │
│                                          │
│         [  AI 추천 받기  ]               │
│    또는  [  직접 선택하기  ]             │
└──────────────────────────────────────────┘
              ↓ Claude API 호출
┌──────────────────────────────────────────┐
│  🤖 AI 추천 결과                          │
│                                          │
│  입력하신 증상을 바탕으로 아래와 같이    │
│  안내드립니다.                           │
│                                          │
│  추천 진료과   외과                      │
│  추천 의사     김철수 전문의              │
│  추천 시간대   오전 (09:00~12:00)        │
│                                          │
│  ⚠️ 이 결과는 AI 참고 안내이며,         │
│     의학적 진단이 아닙니다.              │
│                                          │
│  [ 이 추천으로 예약하기 ]  [ 다시 입력 ] │
└──────────────────────────────────────────┘
              ↓ 예약하기 선택 시
[기존 예약 폼]  진료과·의사·시간 자동 입력
```

### Claude API 호출 설계

```
[Request]
  model   : claude-sonnet-4-6
  system  : 진료과 목록 + 추천 기준 지침 (DB에서 동적 주입)
  user    : 환자 증상 텍스트

[Response - JSON 형식 강제]
  {
    "recommended_department" : "외과",
    "recommended_doctor"     : "김철수",
    "recommended_time"       : "오전",
    "summary"                : "복통·미열 증상으로 외과 진료가 적합합니다.",
    "disclaimer"             : "본 안내는 AI 참고용이며 의학적 진단이 아닙니다."
  }
```

### 시스템 프롬프트 구성

```
당신은 병원 예약 안내 도우미입니다.
환자의 증상을 분석하여 아래 진료과 목록 중 가장 적합한 곳을 추천하세요.
의학적 진단을 내리지 말고, 진료과 선택을 돕는 수준으로만 안내하세요.
반드시 JSON 형식으로만 응답하고, 다른 텍스트는 포함하지 마세요.

[진료과 목록 - DB 동적 주입]
{departments_from_db}
```

### 이미지 입력 제외 결정 근거

| 항목 | 내용 |
| --- | --- |
| 제외 이유 | 파일 업로드 처리, base64 인코딩, 개인정보 고지 등 부가 구현 비용이 크고 4주 일정에 부담 |
| 실용성 | 텍스트 증상 입력만으로 진료과 추천 품질에 유의미한 차이 없음 |
| 향후 계획 | v1.1에서 이미지 첨부 기능 추가 예정 |

---

### 2.2 기능 2 — 병원 규칙 Q&A 챗봇 (내부 직원용)

### 화면 위치

```
ROLE_DOCTOR 진료 화면  →  우측 하단 고정 챗봇 버튼 [💬]
ROLE_NURSE  간호 화면  →  우측 하단 고정 챗봇 버튼 [💬]
```

### 챗봇 UI

```
┌─────────────────────────────────┐
│  🏥 병원 도우미           [✕]   │
├─────────────────────────────────┤
│                                 │
│  병원 규칙·업무 절차에 대해     │
│  질문하세요.                    │
│                                 │
│  [직원]  응급 처치 키트 위치가  │
│          어디인가요?            │
│                                 │
│  [AI]    응급 키트는 3층 간호사 │
│          스테이션 좌측 캐비닛에 │
│          보관되어 있습니다.     │
│                                 │
├─────────────────────────────────┤
│  [질문을 입력하세요...]   [전송] │
└─────────────────────────────────┘
```

### Claude API 호출 설계

```
[Request]
  model   : claude-sonnet-4-6
  system  : "당신은 [병원명] 내부 직원 전용 업무 도우미입니다.
             아래 병원 규칙 문서 내에서만 답변하세요.
             문서에 없는 내용은 '등록된 규칙에서 확인할 수 없습니다'라고 답변하세요.
             의료적 판단은 하지 마세요.
             [병원 규칙 문서]
             {hospital_rules_from_db}"
  user    : 직원 질문 텍스트

[Response]
  규칙 기반 자연어 답변
```

### 병원 규칙 관리 (ROLE_ADMIN)

```
/admin/rules
┌───────────────────────────────────────┐
│  병원 규칙 관리              [+ 추가]  │
├───────────────────────────────────────┤
│  응급 처치 절차          [수정] [삭제] │
│  물품 보관 위치 안내     [수정] [삭제] │
│  당직 근무 규정          [수정] [삭제] │
│  감염 예방 수칙          [수정] [삭제] │
└───────────────────────────────────────┘
```

---

## 3. 추가 테이블 정의 (v4.1 신규)

### 3.1 HOSPITAL_RULE

| 컬럼명 | 타입 | 제약 | 설명 |
| --- | --- | --- | --- |
| `id` | BIGINT | PK, AUTO_INCREMENT |  |
| `title` | VARCHAR(200) | NOT NULL | 규칙 제목 |
| `content` | TEXT | NOT NULL | 규칙 본문 |
| `category` | VARCHAR(50) | NOT NULL | EMERGENCY / SUPPLY / DUTY / HYGIENE / OTHER |
| `is_active` | BOOLEAN | NOT NULL, DEFAULT TRUE | 챗봇 컨텍스트 포함 여부 |
| `created_at` | DATETIME | NOT NULL |  |
| `updated_at` | DATETIME | NOT NULL |  |

### 3.2 LLM_RECOMMENDATION (이미지 관련 컬럼 제거)

| 컬럼명 | 타입 | 제약 | 설명 |
| --- | --- | --- | --- |
| `id` | BIGINT | PK, AUTO_INCREMENT |  |
| `symptom_text` | TEXT | NOT NULL | 환자 입력 증상 텍스트 |
| `recommended_dept` | VARCHAR(100) | NULL | 추천 진료과 |
| `recommended_doctor` | VARCHAR(100) | NULL | 추천 의사명 |
| `recommended_time` | VARCHAR(50) | NULL | 추천 시간대 |
| `llm_response_raw` | TEXT | NULL | LLM 응답 원문 (JSON) |
| `is_used` | BOOLEAN | NOT NULL, DEFAULT FALSE | 실제 예약으로 이어졌는지 여부 |
| `created_at` | DATETIME | NOT NULL |  |

> `has_image` 컬럼 제거 — 이미지 입력 기능 v4.1에서 제외
> 

---

## 4. 범위 정의 (Scope Definition)

### 4.1 ✅ In-Scope — 전체 MVP 기능

```
병원 예약 & 내부 업무 시스템 (MVP v4.1)
│
├─ [외부] 예약
│   ├─ 증상 텍스트 입력 → Claude API 분석 → 추천 결과 확인
│   ├─ 추천 기반 예약 확정 또는 직접 선택 분기
│   ├─ 중복 예약 방지 (doctor + date + time_slot UNIQUE)
│   └─ 예약번호 발급
│
└─ [내부] 로그인
    ├─ ROLE_ADMIN
    │   ├─ 대시보드 통계 (4종 count)
    │   ├─ 예약·의사·직원·진료과·물품 CRUD
    │   └─ 병원 규칙 CRUD  ← LLM 챗봇 데이터 관리
    ├─ ROLE_DOCTOR
    │   ├─ 오늘 진료 목록 / 진료 기록 입력 / 완료 처리
    │   ├─ 병원 규칙 Q&A 챗봇
    │   └─ 챗봇 대화 이력 저장 (세션 단위)
    ├─ ROLE_NURSE
    │   ├─ 오늘 예약 목록 / 환자 정보 수정
    │   ├─ 병원 규칙 Q&A 챗봇
    │   └─ 챗봇 대화 이력 저장 (세션 단위)
    └─ ROLE_STAFF
        ├─ 접수 처리 (RESERVED → RECEIVED)
        └─ 전화 예약 등록
```

### 4.2 ❌ Out-Scope

| 제외 항목 | 이유 | 추후 계획 |
| --- | --- | --- |
| 증상 이미지 입력 | 4주 일정 내 구현 부담, 텍스트로 충분 | v1.1 |
| LLM 추천 정확도 피드백 | 범위 초과 | v1.1 |
| RAG / 벡터 DB | 오버엔지니어링 | v2.0 |
| ROLE_STAFF 챗봇 | 우선순위 조정 | v1.1 |
| 근무 스케줄 / 재고 로그 | 동시성 복잡도 | v1.1 |
| SMS / 이메일 알림 | 외부 API 리스크 | v1.1 |

---

## 5. 일정 계획 — 4주 압축 편성 (WBS & Gantt)

### 5.1 압축 핵심 전략

```
기존 v4.0 (5주)          →  v4.1 (4주) 압축 방식
──────────────────────────────────────────────────
W1: 설계 + 인증           →  W1: 설계 + 인증 (동일)
W2: 예약 + 접수           →  W2: 예약 + 접수 + LLM 선행 준비
W3: 진료 + 관리자         →  W3: 진료 + 관리자 + LLM API 연동 시작
W4: LLM 통합             →  W4: LLM 완성 + 통합 테스트 + 배포
W5: 통합 테스트 + 배포    →  (W4에 병합)
```

> **가능한 이유:** 이미지 처리 제거로 LLM 연동 복잡도가 낮아졌고,
`LlmService` 구현을 책임개발자가 W3 후반에 선행 착수하면
W4에서 개발자가 UI 연결만 담당하여 병렬 처리가 가능하다.
> 

### 5.2 WBS (Work Breakdown Structure)

```
1.0 프로젝트 준비 (W1 전반)
  1.1 ERD 설계 (HOSPITAL_RULE, LLM_RECOMMENDATION 포함)
  1.2 Spring Boot 세팅, Git 브랜치 전략
  1.3 공통 레이아웃 및 기본 UI
  1.4 Staff 로그인 / 4 ROLE Security 설정

2.0 외부 예약 시스템 (W1 후반 ~ W2 전반)
  2.1 비회원 예약 폼 & Patient 저장
  2.2 고정 슬롯 기반 시간 선택
  2.3 중복 예약 방지 로직 (트랜잭션 + DB UNIQUE)
  2.4 예약번호 발급

3.0 내부 직원 시스템 (W2 후반 ~ W3 전반)
  3.1 접수 처리 화면 (ROLE_STAFF)
  3.2 진료 기록 입력 화면 (ROLE_DOCTOR)
  3.3 간호사 화면 (ROLE_NURSE)
  3.4 관리자 전체 CRUD

4.0 LLM 기능 통합 (W3 후반 ~ W4 전반) ← 책임개발자 선행 착수
  4.1 Claude API 연동 설정 (LlmService 구현) — 책임개발자 W3 말 착수
  4.2 증상 분석 API 연동 (텍스트 전용)
  4.3 추천 결과 화면 + 예약 폼 연결
  4.4 병원 규칙 Q&A 챗봇 UI (Doctor/Nurse 화면) + 대화 이력 저장
  4.5 관리자 병원 규칙 CRUD

5.0 마무리 & 배포 (W4 후반)
  5.1 LLM 폴백 처리 (API 실패 시 직접 선택 전환)
  5.2 전체 통합 테스트 (E2E 시나리오)
  5.3 예외 처리 및 유효성 검증
  5.4 면책 고지 문구 최종 확인
  5.5 보안 점검 (ROLE, CSRF, API Key)
  5.6 Linux 서버 배포
```

### 5.3 Gantt Chart

```
Task                                  | W1       | W2       | W3       | W4       |
--------------------------------------|----------|----------|----------|----------|
ERD 설계 & 프로젝트 세팅               | ████     |          |          |          |
공통 레이아웃 & 기본 UI                | ████     |          |          |          |
Staff 로그인 / 4 ROLE Security         | ████     |          |          |          |
비회원 예약 폼 & 슬롯 선택             |    ██████|          |          |          |
중복 예약 방지 로직                    |    ██████|          |          |          |
예약번호 발급                         |          |██        |          |          |
접수 처리 (ROLE_STAFF)                 |          |████      |          |          |
진료 기록 입력 (ROLE_DOCTOR)           |          |    ██████|          |          |
간호사 화면 (ROLE_NURSE)               |          |    ██████|          |          |
관리자 CRUD 전체                       |          |      ████|██        |          |
Claude API 연동 (LlmService) ★책임개발자  |          |          |      ████|          |
증상 분석 + 추천 화면 UI               |          |          |          |████      |
규칙 Q&A 챗봇 UI                      |          |          |          |████      |
병원 규칙 CRUD (관리자)               |          |          |          |████      |
LLM 폴백 처리                         |          |          |          |    ██    |
통합 테스트 & 예외 처리                |          |          |          |    ████  |
보안 점검 & 배포                       |          |          |          |      ████|
```

> ★ 책임개발자가 W3 후반에 `LlmService` 구현을 선행 착수하여
W4 초반 개발자가 UI 연결 작업을 병렬 진행할 수 있도록 한다.
> 

---

## 6. 인력 배치표 (Resource Plan)

### 6.1 역할 및 담당 영역

| 역할 | 인원 | 주요 담당 |
| --- | --- | --- |
| 책임개발자 (Tech Lead) | 1명 | 전체 아키텍처, Security, 예약 핵심 로직, **LlmService + Claude API 연동**, 코드 리뷰, 배포 |
| 개발자 A | 1명 | 비회원 메인(00), 외부 예약 폼, **증상 입력 UI, 추천 결과 화면** |
| 개발자 B | 1명 | STAFF·DOCTOR·NURSE 대시보드(06·11·14), 방문 접수(10), 접수 화면, 진료 기록 화면, **챗봇 UI 컴포넌트** |
| 개발자 C | 1명 | 관리자 화면, 물품 CRUD(27·28·29), **병원 규칙 CRUD(30·31·32)**, 전체 접수 목록(19), 진료과 상세(26) |
| AI 보조 | - | 코드 초안, 프롬프트 초안 작성, 디버깅, UI 템플릿 |

### 6.2 주차별 역할 분배 (4주 압축)

| 주차 | 책임개발자 | 개발자 A | 개발자 B | 개발자 C |
| --- | --- | --- | --- | --- |
| **W1** | ERD 확정 (신규 테이블 포함), Security 4 ROLE, 공통 레이아웃 | 비회원 메인(00), 기본 UI 구성 보조 | STAFF 로그인·대시보드 골격 (화면 01·06) | 관리자 기본 틀·대시보드(17) 구성 |
| **W2** | 예약 중복 방지·트랜잭션, 접수 구조 설계 | 예약 폼·슬롯 선택·예약번호 발급 (화면 02~05) | 방문 접수(10)·접수 처리(07·08)·전화 예약(09) | 관리자 진료과(25·26)·직원(22~24) CRUD |
| **W3** | 상태 흐름 검증, 관리자 구조, **W3 말 LlmService 선행 착수** | 증상 입력·추천 결과 UI 골격 (화면 03) | 진료 기록(13)·DOCTOR·NURSE 대시보드(11·14)·현황(12·15·16) | 전체 접수 목록(19)·물품 CRUD(27·28·29)·규칙 CRUD 골격(30) |
| **W4** | LlmService 완성, 폴백 처리, 통합 테스트, 보안 점검, 배포 | 증상 입력 UI 완성, 추천→예약 연결 (화면 03~04) | 챗봇 UI 완성 + 대화 이력 저장 (C1) | 규칙 CRUD 완성(30·31·32), 전체 UI 점검·정리 |

### 6.3 W4 병렬 작업 구조 (압축 핵심)

```
W4 책임개발자                  W4 개발자 A           W4 개발자 B/C
─────────────────          ───────────────         ──────────────────
LlmService 완성            증상 입력 UI 완성         챗봇 UI 완성
  ↓ API 완성 후 공유 →     추천 결과 → 예약 연결    대화 이력 저장 테이블 연결
폴백 처리 구현             면책 고지 문구 추가        규칙 CRUD 완성
통합 테스트                버그 수정                 최종 UI 정리
보안 점검
배포
```

### 6.4 성공 조건 (4주 압축판)

> **책임개발자 W1 내 구조 완성** — ERD, Security, 레이아웃이 완성되어야 개발자 병렬 작업 시작 가능**책임개발자 W3 말 LlmService 선행 착수** — W4에 개발자가 UI 연결만 담당하도록 API 인터페이스 사전 완성**개발자 기능 1개씩 소유** — 역할 중복 없이 명확한 책임 분리**매주 금요일 통합 미팅** — 브랜치 머지, 다음 주 계획 확정**Scope Lock 원칙** — 4주 내 신규 기능 추가 절대 금지
> 

---

## 7. 커뮤니케이션 계획

| 구분 | 방식 | 주기 | 목적 |
| --- | --- | --- | --- |
| 데일리 체크인 | Discord / Slack | 매일 오전 | 진행 현황, 블로커 확인 |
| 주간 통합 미팅 | 화상 / 대면 | 매주 금요일 | 산출물 검토, 브랜치 머지, 다음 주 계획 |
| 이슈 관리 | GitHub Issues | 수시 | 버그·태스크 추적 |
| 코드 리뷰 | GitHub PR | 기능 완료 시 | 책임개발자 필수 리뷰 |
| 긴급 트러블슈팅 | DM + AI 보조 | 즉시 | 30분 이상 블로킹 즉시 에스컬레이션 |
| **W3 LLM 사전 공유** | 화상 | W3 금요일 | LlmService 인터페이스 팀 공유, W4 역할 확인 |

---

## 8. 형상관리 전략

### 8.1 Git 브랜치 전략

```
main                     → 배포 가능 안정 버전 (Protected)
develop                  → 통합 브랜치
feature/*
  feature/auth
  feature/reservation
  feature/reception
  feature/doctor-treatment
  feature/admin
  feature/inventory
  feature/llm-symptom        ← LLM 증상 추천
  feature/llm-chatbot        ← LLM 규칙 Q&A
  feature/hospital-rules     ← 규칙 관리 CRUD
hotfix/*
release/v1.0
```

### 8.2 커밋 컨벤션

```
feat:   기능 추가 / 변경
fix:    버그 수정
docs:   문서·주석 수정
chore:  설정·빌드·기타

예시)
feat: 증상 입력 폼 구현
feat: LlmService Claude API 연동
fix: LLM 응답 파싱 오류 수정
docs: API 명세서 업데이트
chore: .gitignore API Key 설정 추가
```

### 8.3 버전 로드맵

| 버전 | 내용 | 목표 시점 |
| --- | --- | --- |
| v0.1 | 인증 (4 ROLE), 공통 레이아웃 | W1 말 |
| v0.5 | 예약 + 접수 흐름 완성 | W2 말 |
| v0.8 | 진료·관리자 CRUD + LlmService 골격 | W3 말 |
| **v1.0** | **LLM 완성 + 전체 MVP 배포** | **W4 말** |

---

## 9. 리스크 관리 계획

| # | 리스크 | 가능성 | 영향도 | 대응 전략 | 담당 |
| --- | --- | --- | --- | --- | --- |
| R1 | 예약 중복 오류 | 중 | 높음 | 트랜잭션 + DB UNIQUE 이중 방어 | 책임개발자 |
| R2 | ROLE 접근 권한 누락 | 중 | 높음 | Security URL 초기 완성, E2E 테스트 | 책임개발자 |
| R3 | 상태 흐름 오류 | 중 | 높음 | Service 레이어 상태 검증, 역방향 전이 차단 | 책임개발자 |
| R4 | 개발자 블로킹 | 높음 | 높음 | 기능 1개씩 소유, AI 보조 활용, 30분 룰 | 책임개발자 |
| **R5** | **W3 LlmService 지연 → W4 병목** | **높음** | **높음** | **W3 수요일까지 LlmService 기본 동작 확인, 지연 시 W4 개발자 다른 작업 선 진행** | 책임개발자 |
| R6 | Claude API 응답 실패 / 지연 | 중 | 중 | 폴백: 오류 시 "직접 선택" 화면 즉시 전환, 타임아웃 5초 | 책임개발자 |
| R7 | LLM 부정확한 추천 | 높음 | 중 | 면책 고지 필수 출력, 직접 선택 옵션 상시 노출 | 전원 |
| **R8** | **API Key 외부 노출** | 낮음 | **매우높음** | **환경변수 관리, .gitignore 등록, 서버 사이드 호출 전용** | 책임개발자 |
| R9 | 4주 일정 전체 지연 | 중 | 높음 | Scope Lock 엄수, W4 금요일 데드라인 고정 | 전원 |

### 최우선 리스크 대응 2가지

**R5: W3 LlmService 지연 시 대응 플랜**

```
W3 수요일까지 LlmService 기본 동작 미완성 시:
  → 개발자 A는 추천 결과 화면 대신 "직접 선택" 예약 흐름 마무리
  → 개발자 B는 챗봇 UI 하드코딩 더미 데이터로 골격 완성
  → W4 초반에 LlmService 완성 후 UI 연결로 전환
  → 최악의 경우 챗봇 없이 증상 추천만 배포 (우선순위: 추천 > 챗봇)
```

**R8: API Key 보안**

```
# application.properties (절대 Git 커밋 금지, .gitignore 등록 필수)
claude.api.key=${CLAUDE_API_KEY}

규칙:
- Claude API 호출은 반드시 LlmService(서버 사이드)에서만 수행
- 브라우저 → 서버 → Claude API 방향 엄수
- 브라우저에 API Key 직접 노출 절대 금지
```

---

## 10. 기술 스택

| 구분 | 기술 | 비고 |
| --- | --- | --- |
| Backend | Spring Boot (Gradle) |  |
| View | Mustache (SSR) | 챗봇 UI는 Vanilla JS 비동기 처리 |
| 인증 | 세션 기반 (Spring Security) |  |
| ORM | Spring Data JPA |  |
| Database | MySQL |  |
| **LLM API** | **Claude API (claude-sonnet-4-6)** | **서버 사이드 전용 호출** |
| **HTTP Client** | **Spring WebClient 또는 RestTemplate** | **Claude API 호출** |
| 보안 | BCrypt, CSRF 방어, ROLE URL 제어, **API Key 환경변수 관리** |  |
| 버전 관리 | Git (GitHub) |  |
| 배포 | Linux Server |  |
| AI 보조 | Claude / ChatGPT | 코드 초안, 프롬프트 작성 |

---

## 11. MVP 최종 정의

### 11.1 ✅ 1차 구현 필수 (v1.0 — 4주 내)

**외부 예약 (LLM 포함)**

- [x]  증상 텍스트 입력 폼 (이미지 제외)
- [x]  Claude API 연동 진료과·의사·시간 추천
- [x]  추천 결과 화면 (면책 고지 포함)
- [x]  추천 기반 예약 또는 직접 선택 분기
- [x]  중복 예약 방지, 예약번호 발급

**내부 — LLM 챗봇**

- [x]  병원 규칙 Q&A 챗봇 (ROLE_DOCTOR, ROLE_NURSE)
- [x]  챗봇 대화 이력 저장 (세션 단위, ROLE_DOCTOR / ROLE_NURSE)
- [x]  관리자 병원 규칙 CRUD

**내부 — 기존 기능 + 확장 (v4.2)**

- [x]  비회원 메인 화면 (진료과 안내 포함)
- [x]  STAFF·DOCTOR·NURSE 각 대시보드 (로그인 후 첫 화면)
- [x]  방문 접수 (예약 없이 즉시 RECEIVED 처리)
- [x]  전체 접수 목록 (관리자 당일 모니터링)
- [x]  접수 처리 (ROLE_STAFF)
- [x]  진료 기록 입력·완료 (ROLE_DOCTOR)
- [x]  간호사 현황·환자 수정 화면 (ROLE_NURSE)
- [x]  관리자 전체 CRUD — 직원·진료과 상세(26)·물품 등록(28)·수정(29)·규칙 등록(31)·수정(32)
- [x]  모든 목록 화면 페이징(20건) + 검색·필터

### 11.2 🔒 2차 확장 (v1.1 이후 — Scope Lock)

- [ ]  증상 이미지 첨부 기능 추가
- [ ]  LLM 추천 피드백 수집
- [ ]  ROLE_STAFF 챗봇 확장
- [ ]  RAG 기반 정확도 향상
- [ ]  근무 스케줄 / 재고 입출고 로그
- [ ]  SMS / 이메일 알림

---

## 12. 기대 효과

| 분야 | 기대 효과 |
| --- | --- |
| 환자 경험 | 증상 텍스트 입력만으로 진료과 안내 → 예약 진입 장벽 낮춤 |
| 예약 정확도 | AI 추천으로 잘못된 진료과 예약 감소 |
| 직원 업무 경감 | 반복 질의 응대 대신 챗봇이 병원 규칙 안내 |
| 관리 효율 | 관리자 규칙 문서 등록만으로 챗봇 업데이트 가능 |
| 팀 역량 | 4주 내 LLM API 실전 연동 경험 획득 |

---

## 📊 전체 버전 비교

| 항목 | v3.0 | v4.0 | v4.1 | **v4.2 (최종)** |
| --- | --- | --- | --- | --- |
| 개발 기간 | 4주 | 5주 | 4주 | **4주** |
| 전체 화면 수 | — | — | 22개 | **33개** |
| API 수 | — | — | 48개 | **61개** |
| 증상 입력 | 없음 | 텍스트+이미지 | 텍스트 전용 | **텍스트 전용** |
| LLM 기능 | 없음 | 2종 | 2종 | **2종 (동일)** |
| 대시보드 | 없음 | 없음 | 관리자만 | **전 ROLE 대시보드** |
| 방문 접수 | 없음 | 없음 | 없음 | **신규 추가** |
| 물품/규칙 | CRUD 목록만 | CRUD 목록만 | CRUD 목록만 | **등록·수정 별도 화면** |
| 전체 난이도 | 중 | 중상 | 중상 | **중상** |
| 예상 성공률 | 85~92% | 85~90% | 80~88% | **80~88%** |

---

> **Scope Lock 선언:***4주 개발 기간 중 신규 기능은 절대 추가하지 않는다.
Claude API Key는 반드시 환경변수로만 관리하며 Git에 커밋하지 않는다.
LLM 추천 결과는 참고용임을 항상 명시하고, 의료적 판단으로 오용되지 않도록 한다.*
> 

*문서 변경 이력 및 회의록은 GitHub Wiki에서 관리합니다.*